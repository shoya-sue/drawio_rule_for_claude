# drawio生成チェックリスト

drawioファイル生成時の品質確認用チェックリストです。

---

## 生成前チェックリスト

Claudeに図解を依頼する前に確認する項目：

### 依頼内容

- [ ] 図解の種類を明確にした（フローチャート、アーキテクチャ図、シーケンス図など）
- [ ] 含めるべき要素を明記した
- [ ] 出力形式を指定した（.drawioファイル）

### ルール確認

- [ ] CLAUDE.md（またはrules/core-rules.md）がプロジェクトに含まれている
- [ ] テンプレート（templates/basic.drawio）を参照するよう指示した（任意）

---

## 生成後チェックリスト

生成されたdrawioファイルの品質確認項目：

### 1. mxGraphModel属性

- [ ] `background="none"` が設定されている
- [ ] `page="0"` が設定されている
- [ ] `defaultFontFamily="Helvetica"` が設定されている

### 2. フォント設定（最重要）

- [ ] すべてのmxCell要素のstyleに `fontFamily=Helvetica;` が含まれている
- [ ] すべてのmxCell要素のstyleに `fontSize=18;`（または18以上）が含まれている

### 3. 要素配置順

- [ ] 図形（vertex="1"）がXMLの先頭（背面）に配置されている
- [ ] 矢印（edge="1"）が図形の後（最前面）に配置されている

### 4. 日本語テキスト

- [ ] 日本語テキストに意図しない改行がない
- [ ] 1文字あたり30-40pxの幅が確保されている

### 5. 矢印ラベル

- [ ] 矢印ラベルが矢印から20px以上離れている
- [ ] ラベルが他の要素と重なっていない

---

## 視覚確認チェックリスト

drawioアプリまたはPNG出力で確認する項目：

### drawioアプリで開いて確認

- [ ] ファイルがエラーなく開ける
- [ ] すべての要素が表示されている
- [ ] 矢印が正しく接続されている
- [ ] テキストが正しく表示されている

### PNG出力して確認

```bash
drawio -x -f png -s 2 -t -o output.png input.drawio
```

- [ ] フォントが正しく表示されている（文字化けなし）
- [ ] 背景が透明になっている
- [ ] 解像度が十分である
- [ ] 全体のレイアウトが意図通りである

---

## よくある問題と対処法

### 問題1: フォントがPNG出力で反映されない

**原因**: mxCell要素のstyleにfontFamilyが設定されていない

**対処法**: すべてのmxCell要素のstyleに `fontFamily=Helvetica;` を追加

### 問題2: 矢印が図形の下に隠れる

**原因**: XMLで矢印を先に、図形を後に記述している

**対処法**: 図形（vertex）を先に記述し、矢印（edge）を後に配置

### 問題3: 日本語テキストが改行される

**原因**: mxGeometryのwidthが不足

**対処法**: 幅を拡大（1文字あたり30-40px必要）

### 問題4: ファイルがdrawioアプリで開けない

**原因**: XML構文エラー

**対処法**:
- XMLバリデーションを実行
- `<mxCell id="0" />`と`<mxCell id="1" parent="0" />`が存在するか確認
- 属性値のクォートが閉じているか確認

---

## クイックチェック用コマンド

### フォント設定の確認

```bash
# fontFamilyが設定されているか確認
grep -c "fontFamily=" input.drawio

# fontFamilyが設定されていないmxCellを検出
grep "mxCell.*style=" input.drawio | grep -v "fontFamily="
```

### 要素配置順の確認

```bash
# vertex（図形）とedge（矢印）の出現順を確認
# vertexが先、edgeが後になっていることを確認
grep -n "edge=\"1\"\|vertex=\"1\"" input.drawio
```

---

## チェック完了サイン

すべての項目を確認したら、以下にサインしてください：

- 確認者: _______________
- 確認日: _______________
- 備考: _______________
